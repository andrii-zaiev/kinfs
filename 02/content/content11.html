<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="LERSUS 3.3.0.0" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Корпоративные информационные системы — Теория — Введение в аудитинг</title><script language="javascript" type="text/javascript" src="../../00/styles/files/apiwrapper.js"> </script><script language="javascript" type="text/javascript" src="../../00/styles/files/sco.js"> </script><link href="../../00/styles/files/style.css" rel="stylesheet" type="text/css" /></head><body><table id="mainOuter"><tr><td id="topOuter"><table id="topInner"><tr class="row1"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4" id="shortcuts"><div><ul class="level0"><li><a href="../../00/content/authors1.html">Авторы</a></li><li>|</li><li><a href="../../00/content/contacts1.html">Контакты</a></li><li>|</li><li><a href="../../00/content/instructions1.html">Методические указания</a></li><li>|</li><li><a href="../../00/content/annotation1.html">Аннотация</a></li><li>|</li><li><a href="#" onclick="history.back(); return false;">Назад</a></li></ul></div></td></tr><tr class="row2"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4"><div id="courseTitle">Корпоративные информационные системы</div><div id="courseSubTitle">Физическая организация БД на примере СУБД Oracle : Введение в аудитинг</div></td></tr></table></td></tr><tr><td id="contentOuter"><table id="contentInner"><tr><td class="menuOuter"><table class="menuInner"><tr><td><ul class="level0"><li><a href="../../00/styles/courses.html">Содержание курса</a></li><li><span>Теория</span></li><ul class="level1"><li><a href="../../02/content/content1.html">Основные концепции СУБД Oracle</a></li><li><a href="../../02/content/content2.html">Логическая структура</a></li><li><a href="../../02/content/content3.html">Экстенты и сегменты</a></li><li><a href="../../02/content/content4.html">Табличные пространства и файлы данных </a></li><li><a href="../../02/content/content5.html">Процессы инстанции Oracle </a></li><li><a href="../../02/content/content6.html">Структуры памяти ORACLE</a></li><li><a href="../../02/content/content7.html">Создание таблиц с распределением памяти </a></li><li><a href="../../02/content/content8.html">Объекты базы данных</a></li><li><a href="../../02/content/content9.html">Утилита SQL*Plus</a></li><li><a href="../../02/content/content10.html">Работа со словарем данных</a></li><li><a href="../../02/content/content11.html">Введение в аудитинг</a></li></ul><li><span>Практика</span></li><ul class="level1"><li><a href="../../02/content/example1.html">Практика 1. Настройка структур памяти при создании основных объектов БД</a></li><li><a href="../../02/content/example2.html">Лабораторная работа 1. Работа с основными объектами базы и служебной информацией</a></li></ul><li><span>Текущий контроль знаний</span></li><ul class="level1"><li><a href="../../02/content/multiply-choice-test1.html">Введение в сервер Oracle</a></li><li><a href="../../02/content/multiply-choice-test9.html">Объекты схемы базы данных Oracle</a></li></ul><li><a href="../../02/styles/glossary.html">Словарь терминов</a></li><li><a href="../../02/02.pdf" target="_blank">Версия для печати</a></li></ul></td></tr></table></td><td class="content"><div id="content"><div id="topBlankStripe"> </div><span id="lnk0b28b94806e14f66b35e7255043648f5"> </span><h1 align="left" class="headline-source">     Введение в аудитинг</h1><span id="lnk2ab98ff44aff488b86432da8ee6d0705"> </span><div class="section"><p align="justify" class="paragraph-source">     АУДИТИНГ - это отслеживание и регистрация выбранных действий пользователей в базе данных. </p><p align="justify" class="paragraph-source">     Аудитинг обычно используется:</p><p align="justify" class="paragraph-source">     - для расследования подозрительной деятельности. Например, если данные удаляются из таблиц без санкции, то администратор безопасности может принять решение следить за всеми подключениями к базе данных и за всеми успешными и безуспешными попытками удаления строк во всех таблицах базы данных.</p><p align="justify" class="paragraph-source">     - для сбора информации о конкретных действиях в базе данных. Например, администратор базы данных может собирать статистику о том, какие таблицы обновляются, сколько выполняется логических операций ввода-вывода, или сколько пользователей одновременно подключено в пиковые моменты времени.</p></div><span id="lnkc6f8dc71ac8649fc9eaf39c8e56b1e01"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Типы аудитинга</b></p><p align="justify" class="paragraph-source">     ORACLE поддерживает три основных типа аудитинга:</p><p align="justify" class="paragraph-source">     - Выборочный аудит предложений SQL по типам предложений предложений, безотносительно к конкретной структуре или объекту, например, AUDIT TABLE. Обычно такой аудитинг проводится в широком спектре опций, отслеживая несколько типов связанных действий для каждой опции. Аудитинг предложений можно проводить по выбранным пользователям или по всем пользователям в базе данных.</p><p align="justify" class="paragraph-source">     - Выборочный аудит использования мощных системных привилегий привилегий на определенные действия, например, AUDIT CREATE TABLE. Этот режим более сфокусирован, чем аудит предложений, отслеживая лишь использование определенной привилегии. Аудитинг привилегий можно проводить по выбранным пользователям или по всем пользователям в базе данных.</p><p align="justify" class="paragraph-source">     - Выборочный аудит конкретных предложений на объектов конкретном объекте схемы, например, AUDIT SELECT ON EMP. Этот режим наиболее сфокусирован, отслеживая лишь конкретное предложение на определенном объекте. Аудитинг объектов всегда применяется ко всем пользователям базы данных.</p><p align="justify" class="paragraph-source">     Опции аудитинга устанавливаются для того, чтобы определить тип собираемой информации.</p></div><span id="lnk723a78d0b8f54bdd89390194c9d9f408"> </span><div class="section"><p align="justify" class="paragraph-source">     ORACLE позволяет как фокусировать опции аудита, так и распространять их:</p><p align="justify" class="paragraph-source">     - отслеживать успешные выполнения предложений, безуспешные попытки, или и те, и другие;</p><p align="justify" class="paragraph-source">     - отслеживать выполнение предложения один раз на сессию пользователя или при каждом выполнении предложения;</p><p align="justify" class="paragraph-source">     - отслеживать деятельность всех или конкретного пользователя.</p></div><span id="lnkb1fae5fac6754679bb9d4ef9e535b998"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудиторские записи и аудиторский журнал</b></p><p align="justify" class="paragraph-source">     Аудиторские записи включают такую информацию, как отслеживаемая операция, пользователь, выполнивший эту операцию, и дата/время операции. Аудиторские записи могут сохраняться либо в таблице словаря данных, называемой аудиторским журналом (audit trail), либо в аудиторском журнале операционной системы.</p><p align="justify" class="paragraph-source">     Аудиторский журнал базы данных - это единственная таблица с именем AUD$ в схеме SYS в словаре данных каждой базы данных ORACLE. Предоставляются несколько предопределенных обзоров, чтобы помочь вам использовать эту информацию. </p></div><span id="lnkf3b44e4570c74ee6accbe3534b7cd44a"> </span><h2 align="justify" class="paragraph-headline-source">     Механизмы аудитинга</h2><span id="lnk41ab8f7811224333bdce6f9c2f7af371"> </span><div class="section"><p align="justify" class="paragraph-source">     ORACLE позволяет включать и отключать регистрацию аудиторской информации. Эта возможность позволяет любому полномочному пользователю в любой момент устанавливать опции аудита, но сохраняет контроль за записью аудиторской информации за администратором безопасности. </p><p align="justify" class="paragraph-source">     Если аудитинг включен, то аудиторская запись генерируется на фазе исполнения при выполнении предложения. Предложения SQL внутри программных единиц PL/SQL отслеживаются индивидуально, в соответствии с режимами аудитинга, при выполнении программной единицы. Генерация аудиторской записи и ее включение в аудиторский журнал осуществляются независимо от транзакции пользователя; поэтому, если даже транзакция пользователя откатывается, запись в аудиторском журнале остается подтвержденной.</p><p align="justify" class="paragraph-source">     Аудиторские записи никогда не генерируются сессиями, установленными от имени SYS, или соединениями в режиме INTERNAL. Подключения в этих режимах обходят некоторые внутренние средства ORACLE с целью выполнения специфических административных операций (например, запуска или закрытия базы данных, восстановления и т.д.).</p></div><span id="lnkc863d20d54fb4e91b4f29ecf34287d46"> </span><div class="section"><p align="justify" class="paragraph-source">     Опции аудитинга предложений и аудитинга привилегий, которые действовали на момент соединения пользователя с базой данных, т.е. на момент начала сессии, остаются действительными на все время этой сессии; сессия не видит установок или изменений опций аудитинга, осуществленных в течение ее выполнения. Пользователь базы данных попадет под действие изменившихся режимов аудита лишь после того, как закончит текущую сессию и начнет новую. Напротив, что касается аудитинга объектов, сессия чувствительна ко всем установкам и изменениям опций аудитинга, осуществляемым в течение ее выполнения.</p></div><span id="lnk6888926110534577bfc53ab0e1329c4e"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг в распределенной базе данных</b></p><p align="justify" class="paragraph-source">     Аудитинг автономен для узла; инстанция отслеживает лишь предложения, выдаваемые непосредственно присоединенными пользователями. Локальный ORACLE не может отслеживать действий, имеющих место на удаленной базе данных. Так как удаленные соединения устанавливаются через имя пользователя и связь баз данных, предложения, выданные через соединение по связи баз данных, отслеживаются удаленным ORACLE. Обратитесь к главе 21 для дополнительной информации о распределенных базах данных и связях баз данных.</p></div><span id="lnkcc46b93c21414060a2996babd07cf64f"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг предложений</b></p><p align="justify" class="paragraph-source">     Аудитинг предложений - это выборочное отслеживание связанных групп предложений, которые попадают в две категории:</p><p align="justify" class="paragraph-source">     - Предложения DDL, касающиеся конкретного ТИПА структуры или объекта базы данных, но не конкретного экземпляра структуры или объекта (например, AUDIT TABLE отслеживает все предложения CREATE TABLE и DROP TABLE);</p><p align="justify" class="paragraph-source">     - Предложения DML, касающиеся конкретного ТИПА структуры или объекта базы данных, но не конкретного экземпляра структуры или объекта (например, AUDIT SELECT TABLE отслеживает все предложения SELECT ... FROM TABLE, VIEW или SNAPSHOT, независимо от имени этой таблицы, обзора или снимка).</p><p align="justify" class="paragraph-source">     Аудитинг предложений может быть широким, отслеживая действия всех пользователей базы данных, или узким, отслеживая действия выбранных пользователей.</p></div><span id="lnkbc1124c3fc594b8f9b6b0057e3c920cf"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг привилегий</b></p><p align="justify" class="paragraph-source">     Аудитинг привилегий - это выборочное отслеживание предложений, которые выполняются носителями системных привилегий. Например, аудитинг по системной привилегии SELECT ANY TABLE отслеживает те предложения пользователей, которые выполняются благодаря системной привилегии SELECT ANY TABLE.</p><p align="justify" class="paragraph-source">     Можно отслеживать использование любой системной привилегии. Во всех случаях аудитинга привилегий, перед проверкой системных привилегий выполняется проверка привилегий владельца и объектных привилегий. Если установлены аналогичные опции как для аудитинга предложений, так и для аудитинга привилегий, то будет сгенерирована лишь одна аудиторская запись. Например, если отслеживаются как опция предложения TABLE, так и системная привилегия CREATE TABLE, то при каждом создании таблицы генерируется только одна аудиторская запись.</p><p align="justify" class="paragraph-source">     Аудитинг привилегий более сфокусирован, чем аудитинг предложений, потому что здесь каждая опция отслеживает лишь специфические типы предложений, а не список связанных предложений. Например, опция аудитинга предложений TABLE отслеживает предложения CREATE TABLE, ALTER TABLE и DROP TABLE, тогда как опция аудитинга привилегий CREATE TABLE отслеживает только предложение CREATE TABLE, ибо лишь для этого предложения требуется системная привилегия CREATE TABLE.</p><p align="justify" class="paragraph-source">     Аудитинг привилегий может быть широким, отслеживая действия всех пользователей базы данных, или узким, отслеживая действия выбранных пользователей.</p></div><span id="lnk9229e5884a38456cb83314e0a48ff14c"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг объектов</b></p><p align="justify" class="paragraph-source">     Аудитинг объектов - это выборочное отслеживание специфических предложений DML (включая запросы), а также предложений GRANT и REVOKE, для конкретных объектов схем. Аудитинг объектов отслеживает те операции, которые выполняются благодаря объектным привилегиям, например, предложения SELECT и DELETE по данной таблице.</p><p align="justify" class="paragraph-source">     Можно отслеживать предложения, которые обращаются к таблицам, обзорам, последовательностям, НЕЗАВИСИМЫМ хранимым процедурам и функциям, а также пакетам. (Нельзя индивидуально отслеживать процедуры и функции, определенные внутри пакетов.) Заметьте, что предложения, которые обращаются к кластерам, связям баз данных, индексам или синонимам, непосредственно не отслеживаются; однако доступ через один из таких объектов может быть косвенно отслежен через аудит операций, воздействующих на базовую таблицу. Опции аудитинга объектов всегда действуют на всех пользователей базы данных; нельзя установить эти опции лишь для выбранного списка пользователей. ORACLE предоставляет механизм установки умалчиваемых опций аудита объектов для всех отслеживаемых объектов схем.</p></div><span id="lnk0511a76b89c04bdbb944e28f290fff6b"> </span><div class="section"><p align="justify" class="paragraph-source"><b>Опции аудита объектов для обзоров и процедур</b></p></div><span id="lnka54584fc189c43ad910e42295615efac"> </span><div class="section"><p align="justify" class="paragraph-source">     Так как обзоры и процедуры (включая хранимые функции, пакеты и триггеры) обращаются в своих определениях к базовым объектам, аудитинг для обзоров и процедур обладает некоторыми уникальными свойствами. Так, в результате использования обзора или процедуры потенциально может быть сгенерировано несколько аудиторских записей. Под действие включенных опций аудитинга попадает не только факт использования обзора или процедуры, но и предложения SQL, выполняемые в результате обращения к этому обзору или процедуре, подвергаются аудитингу согласно действующим опциям аудитинга объектов (в том числе умалчиваемых опций аудитинга).</p></div><span id="lnk22ffbbef0ee34ee89df6aace8e7f2baf"> </span><div class="section"><p align="justify" class="paragraph-source">     ORACLE позволяет фокусировать все виды аудита в двух областях:</p><p align="justify" class="paragraph-source">     - по успешным или безуспешным выполнениям отслеживаемого предложения SQL;</p><p align="justify" class="paragraph-source">     - по режиму генерации аудиторских записей: BY SESSION или BY ACCESS;</p><p align="justify" class="paragraph-source">     Кроме того, аудитинг предложений и привилегий можно проводить для специфических пользователей или для всех пользователей в базе данных.</p></div><span id="lnkf3a751fe1f29408cbff5fd9bb6c6f4cd"> </span><div class="section"><p align="justify" class="paragraph-source">     Для всех видов аудитинга, ORACLE разрешает проводить выборочный аудит успешных выполнений предложений, безуспешных выполнений предложений, либо и тех, и других. Это позволяет вам отслеживать действия пользователей, даже если отслеживаемые предложения не выполняются успешно.</p><p align="justify" class="paragraph-source">     Безуспешное выполнение предложения может быть отслежено лишь в том случае, если было выдано законное предложение SQL, сбившееся из-за отсутствия требуемых полномочий или из-за обращения к несуществующему объекту; оно не может быть отслежено, если выдано синтаксически некорректное предложение SQL. Так, включенная опция аудитинга привилегий, требующая отслеживания безуспешных выполнений предложений, будет регистрировать те предложения, которые используют соответствующую системную привилегию, но сбиваются по другим причинам (например, когда привилегия CREATE TABLE установлена, но предложение CREATE TABLE сбивается из-за недостатка квоты в табличном пространстве).</p><p align="justify" class="paragraph-source">     Используя любую форму команды AUDIT, вы можете включить:</p><p align="justify" class="paragraph-source">     - опцию WHENEVER SUCCESSFUL, чтобы отслеживать только успешные выполнения отслеживаемого предложения;</p><p align="justify" class="paragraph-source">     - опцию WHENEVER NOT SUCCESSFUL, чтобы отслеживать только безуспешные выполнения отслеживаемого предложения;</p><p align="justify" class="paragraph-source">     - ни одной из этих опций, чтобы отслеживать как успешные, так и безуспешные выполнения отслеживаемого предложения.     </p></div><span id="lnkb55ba00bdde747f988551463b85cb509"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг BY SESSION и BY ACCESS</b></p><p align="justify" class="paragraph-source">     Большинство опций аудитинга позволяют указать, как должны генерироваться аудиторские записи, когда отслеживаемое предложение выдается многократно в течение одной сессии пользователя. Следующие секции описывают различия между опциями BY SESSION и BY ACCESS команды AUDIT.</p><p align="justify" class="paragraph-source">     BY SESSION вставляет в аудиторский журнал лишь одну аудиторскую запись для отслеживаемого действия, для данного пользователя и данного объекта, на все время сессии.</p><p align="justify" class="paragraph-source">     Чтобы продемонстрировать, как генерируются аудиторские записи в режиме BY SESSION, рассмотрим следующий пример:</p><p align="justify" class="paragraph-source">     Предположим следующее:</p><p align="justify" class="paragraph-source">     - Установлена опция аудитинга предложений SELECT TABLE в режиме BY SESSION. </p><p align="justify" class="paragraph-source">     - Пользователь JWARD подключается к базе данных и выдает пять предложений SELECT для таблицы DEPT, после чего отключается от базы данных. </p><p align="justify" class="paragraph-source">     - Пользователь SWILLIAMS подключается к базе данных и выдает три предложения SELECT для таблицы EMP, после чего отключается от базы данных.</p></div><span id="lnk6ab61cabff7c434fa82a7bfa4e5a3cb9"> </span><div class="section"><p align="justify" class="paragraph-source">     В этом случае аудиторский журнал будет содержать две аудиторские записи для восьми выданных предложений SELECT (по одной для каждой сессии).</p><p align="justify" class="paragraph-source">     Опцию BY SESSION можно использовать и в тех случаях, когда аудиторские записи направляются в аудиторский журнал операционной системы, но при этом аудиторская запись генерируется и записывается при каждой попытке доступа. Поэтому режим BY SESSION в этой конфигурации эквивалентен режиму BY ACCESS.</p></div><span id="lnkeda45e9876ac4c5e8bf144ac8516b116"> </span><div class="section"><p align="justify" class="paragraph-source">     BY ACCESS вставляет в аудиторский журнал аудиторскую запись при каждом выполнении отслеживаемого предложения.</p><p align="justify" class="paragraph-source">     Пример, предположим следующее:</p><p align="justify" class="paragraph-source">     - Установлена опция аудитинга предложений SELECT TABLE в режиме BY SESSION.</p><p align="justify" class="paragraph-source">     - Пользователь JWARD подключается к базе данных и выдает пять предложений SELECT для таблицы DEPT, после чего отключается от базы данных.</p><p align="justify" class="paragraph-source">     - Пользователь SWILLIAMS подключается к базе данных и выдает три предложения SELECT для таблицы DEPT, после чего отключается от базы данных.</p></div><span id="lnkdd6bd46ec3654dbb9050f125f355c8b4"> </span><div class="section"><p align="justify" class="paragraph-source">     В этом случае аудиторский журнал будет содержать восемь аудиторских записи для восьми выданных предложений SELECT.</p></div><span id="lnk256c99d696cd43f1af200b0ec063e703"> </span><div class="section"><p align="justify" class="paragraph-source">     Команда AUDIT позволяет вам специфицировать как режим BY SESSION, так и режим BY ACCESS; по умолчанию принимается режим BY SESSION. Однако некоторые опции аудитинга могут быть установлены только в режиме BY ACCESS, в том числе:</p><p align="justify" class="paragraph-source">     - все опции аудитинга предложений для предложений DDL;</p><p align="justify" class="paragraph-source">     - все опции аудитинга привилегий для предложений DDL.</p></div><span id="lnkd232f69de95d4ee682b95d656f6773a2"> </span><div class="section"><p align="justify" class="paragraph-source">     <b>Аудитинг по пользователям</b></p><p align="justify" class="paragraph-source">     Опции аудитинга предложений и привилегий могут быть либо широкими, отслеживая предложения, выданные любым пользователем, либо сфокусированными, отслеживая предложения, выдаваемые конкретным списком пользователей. Эта возможность позволяет минимизировать количество генерируемых аудиторских записей, ограничивая их лишь определенными пользователями.</p></div></div></td></tr></table></td></tr><tr><td id="bottomOuter"><table id="bottomInner"><tr><td class="cell1"><div> </div></td><td class="cell2"><div>© 2012 ХНУРЭ, ПИ, Широкопетлева М.С., <a href="mailto:mshirokopetleva@gmail.com">mshirokopetleva@gmail.com</a>;   ХНУРЭ, ПИ, Черепанова Ю.Ю.;   ХНУРЭ, ПИ, Мазурова О.А.<br /><a href="http://lersus.de/" title="Данный курс создан с помощью авторской системы LERSUS" target="_blank">Разработано с помощью LERSUS</a></div></td></tr></table></td></tr></table></body></html>