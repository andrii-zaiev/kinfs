<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="LERSUS 3.3.0.0" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Корпоративные информационные системы — Теория — Табличные пространства и файлы данных </title><script language="javascript" type="text/javascript" src="../../00/styles/files/apiwrapper.js"> </script><script language="javascript" type="text/javascript" src="../../00/styles/files/sco.js"> </script><link href="../../00/styles/files/style.css" rel="stylesheet" type="text/css" /></head><body><table id="mainOuter"><tr><td id="topOuter"><table id="topInner"><tr class="row1"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4" id="shortcuts"><div><ul class="level0"><li><a href="../../00/content/authors1.html">Авторы</a></li><li>|</li><li><a href="../../00/content/contacts1.html">Контакты</a></li><li>|</li><li><a href="../../00/content/instructions1.html">Методические указания</a></li><li>|</li><li><a href="../../00/content/annotation1.html">Аннотация</a></li><li>|</li><li><a href="#" onclick="history.back(); return false;">Назад</a></li></ul></div></td></tr><tr class="row2"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4"><div id="courseTitle">Корпоративные информационные системы</div><div id="courseSubTitle">Физическая организация БД на примере СУБД Oracle : Табличные пространства и файлы данных </div></td></tr></table></td></tr><tr><td id="contentOuter"><table id="contentInner"><tr><td class="menuOuter"><table class="menuInner"><tr><td><ul class="level0"><li><a href="../../00/styles/courses.html">Содержание курса</a></li><li><span>Теория</span></li><ul class="level1"><li><a href="../../02/content/content1.html">Основные концепции СУБД Oracle</a></li><li><a href="../../02/content/content2.html">Логическая структура</a></li><li><a href="../../02/content/content3.html">Экстенты и сегменты</a></li><li><a href="../../02/content/content4.html">Табличные пространства и файлы данных </a></li><li><a href="../../02/content/content5.html">Процессы инстанции Oracle </a></li><li><a href="../../02/content/content6.html">Структуры памяти ORACLE</a></li><li><a href="../../02/content/content7.html">Создание таблиц с распределением памяти </a></li><li><a href="../../02/content/content8.html">Объекты базы данных</a></li><li><a href="../../02/content/content9.html">Утилита SQL*Plus</a></li><li><a href="../../02/content/content10.html">Работа со словарем данных</a></li><li><a href="../../02/content/content11.html">Введение в аудитинг</a></li></ul><li><span>Практика</span></li><ul class="level1"><li><a href="../../02/content/example1.html">Практика 1. Настройка структур памяти при создании основных объектов БД</a></li><li><a href="../../02/content/example2.html">Лабораторная работа 1. Работа с основными объектами базы и служебной информацией</a></li></ul><li><span>Текущий контроль знаний</span></li><ul class="level1"><li><a href="../../02/content/multiply-choice-test1.html">Введение в сервер Oracle</a></li><li><a href="../../02/content/multiply-choice-test9.html">Объекты схемы базы данных Oracle</a></li></ul><li><a href="../../02/styles/glossary.html">Словарь терминов</a></li><li><a href="../../02/02.pdf" target="_blank">Версия для печати</a></li></ul></td></tr></table></td><td class="content"><div id="content"><div id="topBlankStripe"> </div><span id="lnk6f5d303148984da6b6f1ae7e4e137822"> </span><h1 align="left" class="headline-source">     Табличные пространства и файлы данных </h1><span id="lnkde36dc77ffd64a5c8eb287d13b375bd0"> </span><div class="section"><p align="justify" class="paragraph-source">     Кроме рассмотренных выше способов физического распределения памяти под логические объекты БД, стоит отметить, что на самом верхнем уровни физическое представление БД следующее: </p><p align="justify" class="paragraph-source">     - файлы данных - хранят собственно данные БД (его структура - коммерческая тайна); </p><p align="justify" class="paragraph-source">     - файл контрольных точек - хранит управляющую информацию, необходимую для работы процессов Oracle (см. тему "Физическая и логическая структура Oracle"); </p><p align="justify" class="paragraph-source">     - файлы журнала повторения работы (или журналы повтора, журналы транзакций) - хранят незавершенный транзакции; </p><p align="justify" class="paragraph-source">     - файл настроек ( INIT . ORA ) - управляющий файл, который хранит все параметры запуска БД Oracle . </p><p align="justify" class="paragraph-source">     База данных ORACLE составлена из одного или и табличные нескольких единиц логической памяти, называемых <i><b>табличными пространствами.</b></i> </p><p align="justify" class="paragraph-source">     Таким образом, используемые данные базы данных ORACLE логически хранятся в табличных пространствах, а физически располагаются в файлах данных, ассоциированных с соответствующим табличным пространством. Рисунок 4 иллюстрирует эту взаимосвязь. </p><p align="justify" class="paragraph-source">     </p><p align="justify" class="paragraph-source"></p><p align="center" class="paragraph-source"><img src="../res/files/th1_8_0__2_.JPG" height="308px" width="536px" alt="" /> </p><p align="center" class="paragraph-source">Рисунок 4 - Файлы данных и табличные пространства </p><p align="center" class="paragraph-source">     </p><p align="justify" class="paragraph-source">     Таким образом, <i><b>файлы данных</b></i> - физические структуры, каждая из которых связана с одним табличным пространством. Объекты БД (таблицы, индексы и т.п.) хранятся в табличных пространствах, и могут располагаться в нескольких файлах данных. </p><p align="justify" class="paragraph-source">     Все данные базы данных хранятся в табличных пространствах этой базы данных. </p><p align="justify" class="paragraph-source">     Каждое табличное пространство базы данных ORACLE пространства составлено из одного или нескольких файлов данных. </p><p align="justify" class="paragraph-source">     Файлы данных табличного пространства физически хранят соответствующие данные базы данных на диске. </p><p align="justify" class="paragraph-source">     Данные базы данных в совокупности хранятся в файлах данных, из которых состоит каждое табличное пространство этой базы данных (см. рис. 5). </p><p align="justify" class="paragraph-source">     </p><p align="justify" class="paragraph-source"></p><p align="center" class="paragraph-source"><img src="../res/files/th1_9_0__1_.JPG" height="459px" width="499px" alt="" /> </p><p align="center" class="paragraph-source">Рисунок 5 - Физическая структура базы данных Oracle </p><p align="center" class="paragraph-source">     </p><p align="justify" class="paragraph-source">     Например, простейшая база данных ORACLE могла бы иметь одно табличное пространство с одним файлом данных. Более сложная база данных могла бы иметь три табличных пространства, каждое из которых состоит из двух файлов данных (что в совокупности дает шесть файлов данных). </p><p align="justify" class="paragraph-source">     Следующая команда позволяет создать табличное пространство: </p><p align="justify" class="paragraph-source">CREATE TABLESPACE </p><p align="justify" class="paragraph-source">     Для выполнения оператора необходимы полномочия CREATE TABLESPACE . </p><p align="justify" class="paragraph-source">     Табличное пространство SYSTEM должно содержать не менее двух сегментов отката, включая сегмент отката SYSTEM . </p></div><span id="lnka450304e81b94af6bc859e3ac78845cd"> </span><h2 align="left" class="paragraph-headline-source">Синтаксис команды созданиия табличного пространства</h2><span id="lnkecd039791b5f4890b9a5b6e1e86a8967"> </span><div class="section"><p align="justify" class="paragraph-source">Синтаксис команды созданиия табличного пространства показан на рисунке 6.</p><p align="justify" class="paragraph-source">     </p><p align="center" class="paragraph-source"><img src="../res/files/th1_10_0__1_.JPG" height="258px" width="627px" alt="" /> </p><p align="center" class="paragraph-source">Рисунок 6 - Синтаксис команды созданиия табличного пространства</p><p align="center" class="paragraph-source">     </p><p align="justify" class="paragraph-source">     Ключевые слова и параметры: </p><p align="justify" class="paragraph-source">     - DATAFILE - указывает один или несколько файлов данных, образующих создаваемое табличное пространство. </p><p align="justify" class="paragraph-source">     - AUTOEXTEND - разрешает или запрещает автоматическое увеличение файлов данных. </p><p align="justify" class="paragraph-source">     - OFF - режим запрета автоматического расширения файлов данных. При этом значения параметров NEXT и MAXSIZE обнуляются. Если в дальнейшем потребуется разрешить автоматическое расширение файлов данных, то это можно установить оператором ALTER TABLESPACE AUTOEXTEND , установив новые значения параметров NEXT и MAXSIZE . </p><p align="justify" class="paragraph-source">     - NEXT - размер дискового пространства, добавляемого при необходимости каждый раз в режиме автоматического увеличения дискового пространства. Этот параметр иногда называется экстентом ( extent ). </p><p align="justify" class="paragraph-source">     - MAXSIZE - максимальный размер дискового пространства, которое можно выделить под файл данных. </p><p align="justify" class="paragraph-source">     - UNLIMITED - устанавливает неограниченный размер дискового пространства, выделяемого под файл данных. </p><p align="justify" class="paragraph-source">     - DEFAULT STORAGE - определяет для всех объектов, создаваемых в табличном пространстве, значения параметром хранения по умолчанию. </p><p align="justify" class="paragraph-source">     - ONLINE - устанавливает для данного табличного пространства оперативный режим, который позволяет использовать его сразу после создания. </p><p align="justify" class="paragraph-source">     - OFFLINE - устанавливает для данного табличного пространства автономный режим, делающий его недоступным для использования. </p><p align="justify" class="paragraph-source">     - Отметим, что режим функционирования табличного пространства можно изменить оператором ALTER TABLESPACE . Установленные режимы хранятся в словаре данных в виде DBA _ TABLESPACES . </p><p align="justify" class="paragraph-source">     - PERMANENT - определяет, что табличное пространство будет использоваться для хранения постоянных объектов. </p></div><span id="lnk079b3ac1d0ec40e8b634094465103483"> </span><div class="section"><p align="justify" class="paragraph-source">     При создании объекта схемы, такого как таблица или индекс, создается сегмент этого объекта в табличном пространстве базы данных. Например, предположим, что таблица создается в указанном табличном пространстве с помощью команды CREATE TABLE с опцией TABLESPACE. Пространство для сегмента данных этой таблицы распределяется в одном или нескольких файлах данных, составляющих это табличное пространство. Сегмент объекта может размещаться лишь в одном табличном пространстве базы данных. </p><p align="justify" class="paragraph-source">     Администратор базы данных может использовать табличные пространства для: </p><p align="justify" class="paragraph-source">     - управления распределением памяти для объектов базы данных; </p><p align="justify" class="paragraph-source">     - установления квот памяти для пользователей базы данных; </p><p align="justify" class="paragraph-source">     - управления доступностью данных путем перевода отдельных табличных пространств в состояния online или offline; </p><p align="justify" class="paragraph-source">     - копирования и восстановления данных; </p><p align="justify" class="paragraph-source">     - распределения данных по устройствам для повышения производительности. </p><p align="justify" class="paragraph-source">     АБД может создавать новые табличные пространства, добавлять и удалять файлы данных из табличных пространств, устанавливать и изменять умалчиваемые характеристики пространства для сегментов, создаваемых в табличном пространстве, а также удалять табличные пространства. </p></div><span id="lnkdc31067140e8408c8e6c10e4058f2e66"> </span><h2 align="left" class="paragraph-headline-source">     Табличное пространство SYSTEM </h2><span id="lnke7cc819d24cd4e51919bbd37bde6124b"> </span><div class="section"><p align="justify" class="paragraph-source">     Каждая база данных ORACLE содержит табличное пространство SYSTEM, которое создается автоматически при создании базы данных. Табличное пространство SYSTEM всегда содержит таблицы словаря данных для всей базы данных. Небольшой базе данных может оказаться достаточным одного табличного пространства SYSTEM; однако рекомендуется создать по меньшей мере одно дополнительное пространство, чтобы хранить данные пользователей отдельно от информации словаря данных. Это позволит вам более гибко осуществлять разнообразные операции администрирования, а также уменьшит соперничество за одни и те же файлы данных между объектами словаря и объектами схем. </p><p align="justify" class="paragraph-source">     Табличное пространство SYSTEM должно всегда находиться в состоянии онлайн и не может быть переведено в офлайн. Все данные, хранящиеся от имени хранимых программных единиц PL/SQL (процедуры, функции, пакеты и триггеры), размещаются в табличном пространстве SYSTEM. Если для базы данных создается много таких объектов, то АБД должен спланировать память, которая будет занята в табличном пространстве SYSTEM под эти объекты. </p></div><span id="lnkff10c515880246d99e4299d591f3dc8f"> </span><h2 align="left" class="paragraph-headline-source">     Распределение дополнительного пространства для базы данных</h2><span id="lnkfaf25a1e0c084d0fa1de0e6ad46c1f60"> </span><div class="section"><p align="justify" class="paragraph-source">     Чтобы расширить базу данных, к одному из существующих в ней табличных пространств можно добавить второй файл данных, тем самым, увеличив величину дисковой памяти, распределенной для соответствующего табличного пространства. </p><p align="justify" class="paragraph-source">     Размер базы данных и размеры табличных пространств увеличиваются с добавлением новых файлов данных. Альтернативно, АБД может создать новое табличное пространство (определяемое дополнительным файлом данных), чтобы увеличить размер базы данных. </p><p align="justify" class="paragraph-source">     <i><b>Размер табличного пространства</b></i> - это размер его файла данных или суммарный размер всех файлов данных, составляющих это табличное пространство. Размер базы данных - это общий размер всех табличных пространств, составляющих базу данных. </p></div><span id="lnkc732e5fd61194211a134af2d52c13eb1"> </span><h2 align="left" class="paragraph-headline-source">     Онлайновые и офлайновые табличные пространства </h2><span id="lnkd7298e788c3b438892410797b7065f63"> </span><div class="section"><p align="justify" class="paragraph-source">     АБД может перевести любое табличное пространство в базе данных ORACLE в состояние <i><b>онлайн </b></i>(т.е. доступно) или <i><b>офлайн </b></i>(недоступно), если база данных открыта. Единственным исключением является то, что табличное пространство SYSTEM всегда находится в онлайне, ибо словарь данных должен быть всегда доступен ORACLE. Обычное состояние табличного пространства - онлайн, так что данные, содержащиеся в нем, доступны пользователям базы данных. </p><p align="justify" class="paragraph-source">     Однако администратору может понадобиться перевод табличного пространства в офлайн по одной из следующих причин: </p><p align="justify" class="paragraph-source">     - чтобы сделать часть базы данных недоступной, сохраняя в то же время нормальный доступ к остальной части; </p><p align="justify" class="paragraph-source">     - чтобы выполнить резервное копирование офлайнового табличного пространства (хотя такое копирование можно осуществлять и в онлайне, одновременно с использованием табличного пространства); </p><p align="justify" class="paragraph-source">     - чтобы сделать приложение вместе с его группой таблиц временно недоступным на время обновления или сопровождения этого приложения. </p><p align="justify" class="paragraph-source">     Когда табличное пространство переводится в офлайн, ORACLE не позволяет последующим предложениям SQL обращаться к объектам этого табличного пространства. Активные транзакции с уже выполненными предложениями, обращавшимися к данным в переведенном в офлайн табличном пространстве, не затрагиваются на уровне транзакции; однако данные отката, соответствующие таким предложениям, сохраняются в отсроченном сегменте отката (в табличном пространстве SYSTEM) и будут применены к табличному пространству, если потребуется, когда оно будет переведено в онлайн. Табличное пространство не может быть переведено в офлайн, если оно содержит активные сегменты отката. Табличное пространство может быть переведено в офлайн лишь в том случае, если все сегменты отката, содержащиеся в нем, не используются. </p><p align="justify" class="paragraph-source">     В словаре данных (в табличном пространстве SYSTEM) отмечается, переведено ли пространство в онлайн или в офлайн. Если табличное пространство было в состоянии офлайн в момент закрытия базы данных, оно будет в том же состоянии и при последующем монтировании и открытии базы данных. Табличное пространство может быть переведено в онлайн только той базой данных, которой оно переводилось в офлайн, поскольку необходимая информация словаря данных находится в табличном пространстве SYSTEM этой базы данных. Табличное пространство в состоянии офлайн не может читаться и редактироваться никакой другой утилитой, кроме ORACLE. Таким образом, табличные пространства не могут передаваться из одной базы данных в другую. При возникновении некоторых ошибок табличное пространство может автоматически переводиться в состояние офлайн (например, если системный процесс DBWR не сумел записать данные за несколько попыток). Пользователи, пытающиеся работать с таблицами этого пространства, получат сообщение об ошибке. Если эти проблемы вызываются сбоем носителя, то после исправления ошибки оборудования должно быть проведено восстановление табличного пространства. При использовании нескольких табличных пространств для разграничения различных типов данных, АБД может также переводить некоторые из табличных пространств в офлайн для некоторых процедур сопровождения, в то время как остальные табличные пространства остаются в онлайне и их информация доступна для работы. Однако при переводе табличных пространств в онлайн могут возникнуть особые обстоятельства. </p><p align="justify" class="paragraph-source">     Например, если для отделения данных таблиц от их индексов используются два табличных пространства, то справедливо следующее: </p><p align="justify" class="paragraph-source">     - Если табличное пространство, содержащее индексы, переведено в офлайн, то запросы по-прежнему могут обращаться к данным, потому что наличие индексов для запросов не обязательно. </p><p align="justify" class="paragraph-source">     - Если в офлайн переведено табличное пространство, которое содержит таблицы, то данные этих таблиц недоступны, и, следовательно, запросы не могут быть выполнены. </p><p align="justify" class="paragraph-source">     В общем, если ORACLE определяет, что в онлайновых табличных пространствах достаточно информации для выполнения предложения, он выполняет его. Если необходимы данные из офлайнового табличного пространства, предложение возвратит ошибку. </p></div><span id="lnk202a3901d5044d958faac6c330964ed1"> </span><h2 align="left" class="paragraph-headline-source">     Файлы данных</h2><span id="lnk85e73c9b786f4a49837b5e8048f7efca"> </span><div class="section"><p align="justify" class="paragraph-source">     Табличное пространство в базе данных ORACLE состоит из одного или нескольких физических <i><b>файлов данных</b></i>. </p><p align="justify" class="paragraph-source">     Файлы данных, ассоциированные с табличным пространством, хранят все данные этого табличного пространства. Любой файл данных может ассоциироваться только с одним табличным пространством и только с одной базой данных. При создании файла данных для табличного пространства ORACLE распределяет ему указанное количество дисковой памяти. Когда файл данных создается, операционная система несет ответственность за очистку старой информации и за установку должных режимов доступа к файлу, прежде чем он будет распределен ORACLE. Если файл велик, этот процесс (очистка) может потребовать значительного времени. Поскольку первым табличным пространством в любой базе данных всегда является SYSTEM, первые файлы данных любой базы данных автоматически распределяются табличному пространству SYSTEM во время создания базы данных.</p></div><span id="lnk10ad4a74005a4999a97f7e0d5f0f416c"> </span><div class="section"><p align="left" class="paragraph-source">     <b>Содержимое файла данных</b></p></div><span id="lnkef41d1525ec2458f86ed596bb9f75811"> </span><div class="section"><p align="justify" class="paragraph-source">     После первоначального создания файла данных соответствующее дисковое пространство еще не содержит никаких данных; однако это пространство зарезервировано за будущими сегментами ассоциированного табличного пространства - оно не может содержать каких-либо иных (чужих) данных. Когда сегмент (например, сегмент данных таблицы) будет создан и начнет увеличиваться в размерах, ORACLE использует свободное место в соответствующих файлах данных, чтобы распределять экстенты для этого сегмента. Данные в сегментах объектов (сегментах данных, сегментах индексов, сегментах отката и т.д.) в табличном пространстве физически хранятся в одном или нескольких файлах данных, составляющих это табличное пространство. Заметьте, что объект схемы не соответствует определенному файлу данных; скорее, файл данных является хранилищем данных любого объекта в конкретном табличном пространстве. Экстенты одного сегмента могут быть распределены в нескольких файлах данных табличного пространства; таким образом, объект может "занимать" один или несколько файлов данных. Обычно АБД и пользователи не могут контролировать, в каких файлах данных размещается объект.</p></div><span id="lnk35c488bdc10946529722afb1f2667708"> </span><div class="section"><p align="left" class="paragraph-source">     <b>Офлайновые файлы данных</b></p></div><span id="lnkb7356383c47f4e51a29affd63dd85a4d"> </span><div class="section"><p align="justify" class="paragraph-source">     Табличные пространства в любой момент можно переводить в <b>офлайн</b> (т.е. делать недоступными) или в <b>онлайн</b> (делать доступными). Поэтому все файлы данных, составляющие табличное пространство, переводятся в офлайн или онлайн одновременно, всей группой. </p><p align="justify" class="paragraph-source">     Индивидуальные файлы данных также могут быть переведены в офлайн; однако это обычно делается лишь при некоторых процедурах восстановления базы данных. </p></div></div></td></tr></table></td></tr><tr><td id="bottomOuter"><table id="bottomInner"><tr><td class="cell1"><div> </div></td><td class="cell2"><div>© 2012 ХНУРЭ, ПИ, Широкопетлева М.С., <a href="mailto:mshirokopetleva@gmail.com">mshirokopetleva@gmail.com</a>;   ХНУРЭ, ПИ, Черепанова Ю.Ю.;   ХНУРЭ, ПИ, Мазурова О.А.<br /><a href="http://lersus.de/" title="Данный курс создан с помощью авторской системы LERSUS" target="_blank">Разработано с помощью LERSUS</a></div></td></tr></table></td></tr></table></body></html>