<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="LERSUS 3.3.0.0" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Корпоративные информационные системы — Теория — Язык PL / SQL. Общие положения </title><script language="javascript" type="text/javascript" src="../../00/styles/files/apiwrapper.js"> </script><script language="javascript" type="text/javascript" src="../../00/styles/files/sco.js"> </script><link href="../../00/styles/files/style.css" rel="stylesheet" type="text/css" /></head><body><table id="mainOuter"><tr><td id="topOuter"><table id="topInner"><tr class="row1"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4" id="shortcuts"><div><ul class="level0"><li><a href="../../00/content/authors1.html">Авторы</a></li><li>|</li><li><a href="../../00/content/contacts1.html">Контакты</a></li><li>|</li><li><a href="../../00/content/instructions1.html">Методические указания</a></li><li>|</li><li><a href="../../00/content/annotation1.html">Аннотация</a></li><li>|</li><li><a href="#" onclick="history.back(); return false;">Назад</a></li></ul></div></td></tr><tr class="row2"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4"><div id="courseTitle">Корпоративные информационные системы</div><div id="courseSubTitle">Языки запросов к базам данных : Язык PL / SQL. Общие положения </div></td></tr></table></td></tr><tr><td id="contentOuter"><table id="contentInner"><tr><td class="menuOuter"><table class="menuInner"><tr><td><ul class="level0"><li><a href="../../00/styles/courses.html">Содержание курса</a></li><li><span>Теория</span></li><ul class="level1"><li><a href="../../03/content/content1.html">Оптимизация запросов</a></li><li><a href="../../03/content/content2.html">Окружение 4-го поколения</a></li><li><a href="../../03/content/content3.html">Язык PL / SQL. Общие положения </a></li><li><a href="../../03/content/content4.html">Переменные и константы. Кодовое множество</a></li><li><a href="../../03/content/content5.html">Типы данных</a></li><li><a href="../../03/content/content6.html">Команды управления</a></li><li><a href="../../03/content/content7.html">Создание хранимых процедур и функций </a></li><li><a href="../../03/content/content8.html">Параметры подпрограмм</a></li><li><a href="../../03/content/content9.html">Встроенные функции PL / SQL</a></li><li><a href="../../03/content/content10.html">Курсоры</a></li><li><a href="../../03/content/content11.html">Исключительные ситуации</a></li><li><a href="../../03/content/content12.html">Обработчики исключений </a></li><li><a href="../../03/content/content13.html">Пакеты</a></li><li><a href="../../03/content/content14.html">Триггеры объектов </a></li></ul><li><span>Практика</span></li><ul class="level1"><li><a href="../../03/content/example1.html">Практика 2. Использование подпрограмм в языках  программирования 4-го поколения</a></li><li><a href="../../03/content/example2.html">Лабораторная работа 2 Подпрограммы как средство создания серверных частей информационных систем на примере СУБД Oracle </a></li><li><a href="../../03/content/example3.html">Практика 3. Создание  и работа с триггерами объектов и событий</a></li><li><a href="../../03/content/example4.html">Лабораторная работа 3. Триггеры объектов и событий базы данных </a></li></ul><li><span>Текущий контроль знаний</span></li><ul class="level1"><li><a href="../../03/content/multiply-choice-test25.html">Управляющие структуры</a></li><li><a href="../../03/content/multiply-answers-test7.html">Подпрограммы языка PL/SQL</a></li><li><a href="../../03/content/multiply-choice-test1.html">Курсоры</a></li><li><a href="../../03/content/multiply-answers-test12.html">Исключительные ситуации</a></li><li><a href="../../03/content/multiply-choice-test19.html">Пакеты</a></li><li><a href="../../03/content/multiply-answers-test3.html">Триггеры</a></li></ul><li><a href="../../03/styles/glossary.html">Словарь терминов</a></li><li><a href="../../03/03.pdf" target="_blank">Версия для печати</a></li></ul></td></tr></table></td><td class="content"><div id="content"><div id="topBlankStripe"> </div><span id="lnkbb4d4f0bef2c4b6580daa11514731828"> </span><h1 align="left" class="headline-source">     Язык PL / SQL. Общие положения </h1><span id="lnk103de63122dc42a294e4c26c0f601d3f"> </span><h2 align="left" class="paragraph-headline-source">     Введение </h2><span id="lnkbc3b459009fe4f4c9e491a5d4cc9419e"> </span><div class="section"><p align="justify" class="paragraph-source">     Даже, если вы не очень опытный программист, вы вероятно отметили, что сам по себе SQL не очень полезен при написании программ. Самое очевидное ограничение - это то, что SQL в основном выполняет по одной команде в каждый момент времени. Типы логических конструкций типа if ... then ( "если ... то" ), for ... do ( "для ... выполнить") и while ... repeat( "пока ... повторять" ) - используемых для структур большинства компьютерных программ, здесь отсутствуют. </p><p align="justify" class="paragraph-source">     Кроме того, интерактивный SQL не может делать многого со значениями, кроме ввода их в таблицу, размещения или распределения их с помощью запросов, и конечно вывода их на какое-то устройство. Более традиционные языки, однако, сильны именно в этих областях. Они разработаны так чтобы программист мог начинать обработку данных, и основываясь на ее результатах, решать, делать ли это действие или другое, или же повторять действие до тех пока не встретится некоторое условие, создавая логические маршруты и циклы. Значения сохраняются в переменных, которые могут использоваться и изменяться с помощью любого числа команд. Это дает вам возможность указывать пользователям на ввод или вывод этих команд из файла, и возможность форматировать вывод сложными способами. </p><p align="justify" class="paragraph-source">     Цель вложенного SQL состоит в том, чтобы объединить эти возможности, позволяющие вам создавать сложные процедурные программы, которые адресуют базу данных посредством SQL - позволяя вам устранить сложные действия в таблицах на процедурном языке, который не ориентирован на такую структуру данных, в тоже время поддерживая структурную строгость процедурного языка. </p><p align="justify" class="paragraph-source">     Эта тема представляет собой общий обзор языка PL/SQL, процедурного расширения SQL фирмы Oracle и включает обсуждение следующих вопросов: </p><p align="justify" class="paragraph-source">     - что из себя представляет язык c PL / SQL ; </p><p align="justify" class="paragraph-source">     - как исполняется PL/SQL; </p><p align="justify" class="paragraph-source">     - типы данных PL/SQL. </p></div><span id="lnk9b910e870e7b40558ff1af2bc450a194"> </span><h2 align="left" class="paragraph-headline-source">     Возможности языка PL/SQL</h2><span id="lnkaf4e1319e51045bd9ed64d12d5785ad9"> </span><div class="section"><p align="justify" class="paragraph-source">     PL/SQL не только позволяет вам вставлять, удалять, обновлять и извлекать данные ORACLE и управлять потоком предложений для обработки этих данных. Более того, вы можете объявлять константы и переменные, определять подпрограммы (процедуры и функции) и перехватывать ошибки времени выполнения. Таким образом, PL/SQL комбинирует мощь манипулирования данными SQL с мощью обработки данных процедурных языков. </p><p align="justify" class="paragraph-source">     PL/SQL имеет два типа подпрограмм - ПРОЦЕДУРЫ и ФУНКЦИИ; всем им можно передавать параметры при вызове. </p><p align="justify" class="paragraph-source">     PL/SQL позволяет вам объединять логически связанные типы, программные объекты и подпрограммы в ПАКЕТ. Каждый пакет легко понять, а интерфейсы между пакетами просты, ясны и хорошо определены. Это облегчает разработку приложений. Если у вас есть Процедурное расширение базы данных, то пакеты можно компилировать и сохранять в базе данных ORACLE, где их содержимое может совместно использоваться многими приложениями. Когда вы первый раз обращаетесь к пакетированной подпрограмме, в память загружается весь пакет. Поэтому последующие обращения к другим подпрограммам пакета не требуют дисковых операций. Таким образом, пакеты могут повысить продуктивность разработки и улучшить производительность выполнения. </p><p align="justify" class="paragraph-source">     Если у вас есть gроцедурное расширение базы данных, то именованные блоки (подпрограммы) PL/SQL можно компилировать отдельно и передавать на постоянное хранение в базу данных ORACLE, где они готовы к исполнению. Подпрограмма, явно созданная (посредством CREATE) с помощью инструмента ORACLE, называется ХРАНИМОЙ подпрограммой. Однажды откомпилированная и сохраненная в словаре данных, она является объектом базы данных, к которому можно обращаться из любого приложения, соединенного с этой базой данных. </p><p align="justify" class="paragraph-source">     Хранимые подпрограммы, определенные внутри пакета, называются ПАКЕТИРОВАННЫМИ подпрограммами; подпрограммы, определенные вне пакета, называются НЕЗАВИСИМЫМИ подпрограммами. (Подпрограммы, определенные внутри других подпрограмм или внутри блока PL/SQL, называются ЛОКАЛЬНЫМИ подпрограммами. Такие подпрограммы недоступны для других приложений, и существуют лишь для удобства окружающего блока.) </p><p align="justify" class="paragraph-source">     Хранимые подпрограммы повышают продуктивность, улучшают производительность, экономят память, обеспечивают лучшую целостность и безопасность. Например, проектируя приложения на базе библиотеки хранимых процедур и функций, вы избежите повторов в кодировании и увеличите вашу продуктивность. </p><p align="justify" class="paragraph-source">     Подпрограммы хранятся в синтаксически разобранной, откомпилированной форме. Поэтому при вызове они загружаются и передаются процессору PL/SQL немедленно. Более того, хранимые подпрограммы используют преимущества разделяемой памяти в ORACLE. Лишь одна копия подпрограммы должна быть загружена в память, чтобы быть доступной многим пользователям. </p></div><span id="lnk4e06dea4d6754a059b310ae57343b744"> </span><h2 align="left" class="paragraph-headline-source">     Архитектура </h2><span id="lnk188917dc86d64d0ca33a37707a205d83"> </span><div class="section"><p align="justify" class="paragraph-source">     Исполнительная система PL/SQL - это технология, а не независимый продукт. Рассматривайте эту технологию как процессор, который исполняет блоки и подпрограммы PL/SQL. Этот процессор может быть установлен в сервере ORACLE или в инструменте разработки приложений, таком как SQL*Forms, SQL*Menu или SQL*ReportWriter. Таким образом, PL/SQL может располагаться в двух окружениях: </p><p align="justify" class="paragraph-source">     - в сервере ORACLE; </p><p align="left" class="paragraph-source">     - в инструментах ORACLE. </p><p align="justify" class="paragraph-source">     Эти два окружения независимы. PL/SQL может быть доступен в сервере, но недоступен в инструментах, или наоборот. В любом окружении, процессор PL/SQL принимает как ввод любой действительный блок или подпрограмму PL/SQL. </p><p align="justify" class="paragraph-source">     Инструменты разработки приложений, в которых нет локального процессора PL/SQL, вынуждены обращаться к ORACLE для обработки блоков и подпрограмм PL/SQL. Сервер ORACLE, когда он содержит процессор PL/SQL, может обрабатывать как блоки и подпрограммы PL/SQL, так и одиночные предложения SQL. Сервер передает блоки и подпрограммы своему локальному процессору PL/SQL. </p><p align="justify" class="paragraph-source">     Инструмент разработки приложений может обрабатывать блоки PL/SQL, если он содержит процессор PL/SQL. Инструмент передает эти блоки своему локальному процессору PL/SQL. Процессор PL/SQL исполняет все процедурные предложения на стороне приложения, а в ORACLE посылает лишь предложения SQL. Таким образом, большая часть работы выполняется на стороне приложения, а не на стороне сервера. </p><p align="justify" class="paragraph-source">     Более того, если блок не содержит предложений SQL, то процессор исполняет весь блок на стороне приложения. Это полезно, если ваше приложение выгадывает за счет условного и итеративного управления.</p></div><span id="lnk481e16be96b640cb936a9da465641d9c"> </span><h2 align="left" class="paragraph-headline-source">     Как исполняется PL/SQL </h2><span id="lnkc186f7dfae62486c985ebd438da62e52"> </span><div class="section"><p align="justify" class="paragraph-source">     Процессор PL/SQL (engine) - это специальная компонента многих продуктов ORACLE, в том числе сервера ORACLE, которая занимается обработкой PL/SQL. </p><p align="justify" class="paragraph-source">     Процедура (или пакет) хранится в базе данных. Когда процедура, хранящаяся в базе данных, вызывается из приложения, откомпилированная процедура (или пакет, в котором она содержится) загружается в разделяемый пул в области SGA, и исполнители PL/SQL и SQL совместно обрабатывают предложения в этой процедуре. </p><p align="left" class="paragraph-source">     Процессор PL/SQL встроен в следующие продукты Oracle: </p><p align="left" class="paragraph-source">     - Сервер ORACLE с процедурной опцией; </p><p align="left" class="paragraph-source">     - SQL*Forms (версия 3 и позже); </p><p align="left" class="paragraph-source">     - SQL*Menu (версия 5 и позже); </p><p align="left" class="paragraph-source">     - SQL*ReportWriter (версия 2 и позже);</p><p align="left" class="paragraph-source">     - Oracle Graphics (версия 2 и позже); </p><p align="justify" class="paragraph-source">     Если вы имеете ORACLE с процедурной опцией, то вы можете вызывать хранимую процедуру из другого блока PL/SQL, который может быть как анонимным блоком, так и другой хранимой процедурой. Кроме того, вы можете передавать ORACLE анонимные блоки из приложений, разработанных с помощью следующих инструментов: </p><p align="left" class="paragraph-source">     - Прекомпиляторов ORACLE (включая пользовательские выходы); </p><p align="left" class="paragraph-source">     - Интерфейсов вызова ORACLE (OCI) * SQL*Plus * SQL*DBA. </p></div></div></td></tr></table></td></tr><tr><td id="bottomOuter"><table id="bottomInner"><tr><td class="cell1"><div> </div></td><td class="cell2"><div>© 2012 ХНУРЭ, ПИ, Широкопетлева М.С., <a href="mailto:mshirokopetleva@gmail.com">mshirokopetleva@gmail.com</a>;   ХНУРЭ, ПИ, Черепанова Ю.Ю.;   ХНУРЭ, ПИ, Мазурова О.А.<br /><a href="http://lersus.de/" title="Данный курс создан с помощью авторской системы LERSUS" target="_blank">Разработано с помощью LERSUS</a></div></td></tr></table></td></tr></table></body></html>