<html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="generator" content="LERSUS 3.3.0.0" /><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Корпоративные информационные системы — Теория — Встроенные функции PL / SQL</title><script language="javascript" type="text/javascript" src="../../00/styles/files/apiwrapper.js"> </script><script language="javascript" type="text/javascript" src="../../00/styles/files/sco.js"> </script><link href="../../00/styles/files/style.css" rel="stylesheet" type="text/css" /></head><body><table id="mainOuter"><tr><td id="topOuter"><table id="topInner"><tr class="row1"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4" id="shortcuts"><div><ul class="level0"><li><a href="../../00/content/authors1.html">Авторы</a></li><li>|</li><li><a href="../../00/content/contacts1.html">Контакты</a></li><li>|</li><li><a href="../../00/content/instructions1.html">Методические указания</a></li><li>|</li><li><a href="../../00/content/annotation1.html">Аннотация</a></li><li>|</li><li><a href="#" onclick="history.back(); return false;">Назад</a></li></ul></div></td></tr><tr class="row2"><td class="cell1"><div> </div></td><td class="cell2"><div> </div></td><td class="cell3"><div> </div></td><td class="cell4"><div id="courseTitle">Корпоративные информационные системы</div><div id="courseSubTitle">Языки запросов к базам данных : Встроенные функции PL / SQL</div></td></tr></table></td></tr><tr><td id="contentOuter"><table id="contentInner"><tr><td class="menuOuter"><table class="menuInner"><tr><td><ul class="level0"><li><a href="../../00/styles/courses.html">Содержание курса</a></li><li><span>Теория</span></li><ul class="level1"><li><a href="../../03/content/content1.html">Оптимизация запросов</a></li><li><a href="../../03/content/content2.html">Окружение 4-го поколения</a></li><li><a href="../../03/content/content3.html">Язык PL / SQL. Общие положения </a></li><li><a href="../../03/content/content4.html">Переменные и константы. Кодовое множество</a></li><li><a href="../../03/content/content5.html">Типы данных</a></li><li><a href="../../03/content/content6.html">Команды управления</a></li><li><a href="../../03/content/content7.html">Создание хранимых процедур и функций </a></li><li><a href="../../03/content/content8.html">Параметры подпрограмм</a></li><li><a href="../../03/content/content9.html">Встроенные функции PL / SQL</a></li><li><a href="../../03/content/content10.html">Курсоры</a></li><li><a href="../../03/content/content11.html">Исключительные ситуации</a></li><li><a href="../../03/content/content12.html">Обработчики исключений </a></li><li><a href="../../03/content/content13.html">Пакеты</a></li><li><a href="../../03/content/content14.html">Триггеры объектов </a></li></ul><li><span>Практика</span></li><ul class="level1"><li><a href="../../03/content/example1.html">Практика 2. Использование подпрограмм в языках  программирования 4-го поколения</a></li><li><a href="../../03/content/example2.html">Лабораторная работа 2 Подпрограммы как средство создания серверных частей информационных систем на примере СУБД Oracle </a></li><li><a href="../../03/content/example3.html">Практика 3. Создание  и работа с триггерами объектов и событий</a></li><li><a href="../../03/content/example4.html">Лабораторная работа 3. Триггеры объектов и событий базы данных </a></li></ul><li><span>Текущий контроль знаний</span></li><ul class="level1"><li><a href="../../03/content/multiply-choice-test25.html">Управляющие структуры</a></li><li><a href="../../03/content/multiply-answers-test7.html">Подпрограммы языка PL/SQL</a></li><li><a href="../../03/content/multiply-choice-test1.html">Курсоры</a></li><li><a href="../../03/content/multiply-answers-test12.html">Исключительные ситуации</a></li><li><a href="../../03/content/multiply-choice-test19.html">Пакеты</a></li><li><a href="../../03/content/multiply-answers-test3.html">Триггеры</a></li></ul><li><a href="../../03/styles/glossary.html">Словарь терминов</a></li><li><a href="../../03/03.pdf" target="_blank">Версия для печати</a></li></ul></td></tr></table></td><td class="content"><div id="content"><div id="topBlankStripe"> </div><span id="lnkf0640601326c4955b712793a7fac87b7"> </span><h1 align="left" class="headline-source">     Встроенные функции PL / SQL</h1><span id="lnk3a0f176b32524e388aa6a5bc46b72007"> </span><div class="section"><p align="justify" class="paragraph-source">     PL/SQL предоставляет много мощных функций, помогающих манипулировать данными. Возможно использование функций всюду, где допускаются выражения того же типа. Более того, можно вкладывать вызовы функций друг в друга. </p></div><span id="lnka7924715b0964392bc90ef6c7bb521c4"> </span><div class="section"><p align="left" class="paragraph-source">     Для встроенных функций выделяют следующие категории: </p><p align="left" class="paragraph-source">     - функции сообщений об ошибках; </p><p align="left" class="paragraph-source">     - числовые функции; </p><p align="left" class="paragraph-source">     - символьные функции; </p><p align="left" class="paragraph-source">     - функции преобразований; </p><p align="left" class="paragraph-source">     - календарные функции; </p><p align="left" class="paragraph-source">     - смешанные функции. </p><p align="justify" class="paragraph-source">     В предложениях SQL можно использовать все встроенные функции, за исключением функций сообщений об ошибках SQLCODE и SQLERRM. В процедурных предложениях можно использовать все встроенные функции, за исключением смешанной функции DECODE. </p><p align="justify" class="paragraph-source">     Групповые функции SQL AVG, MIN, MAX, COUNT, SUM не встроены в PL/SQL. Тем не менее, возможно их использование в предложениях SQL (но не в процедурных предложениях PL/SQL). </p><p align="justify" class="paragraph-source">     В дополнительных материалах для каждой встроенной функции приводятся ее аргументы, типы данных этих аргументов, и тип данных возвращаемого значения. Рассмотрим примеры встроенных функций. </p><p align="justify" class="paragraph-source">     Числовые функции принимают числовые аргументы и возвращают числовые значения. Трансцендентные функции включают тригонометрические, логарифмические и экспоненциальные функции. </p></div><span id="lnk73a9f768f9f44b7abbbb4c3aea53d633"> </span><div class="section"><p align="justify" class="paragraph-source"><b>function MOD (m NUMBER, n NUMBER) return NUMBER </b></p><p align="justify" class="paragraph-source">     Возвращает остаток от деления m на n. Если n равно 0, возвращается m. </p><p align="justify" class="paragraph-source"><b>function POWER (m NUMBER, n NUMBER) return NUMBER </b></p><p align="justify" class="paragraph-source">     Возвращает m в степени n. База m и степень n могут быть любыми числами, но если m отрицательно, то n должно быть целым. </p><p align="justify" class="paragraph-source"><b>function ROUND (m NUMBER [, n NUMBER]) return NUMBER </b></p><p align="justify" class="paragraph-source">     Округляет m до n десятичных позиций. Если n опущено, то m округляется до нуля десятичных позиций (т.е. до целого). Число n может быть отрицательным, что позволяет округлять до десятков, сотен и т.п. </p><p align="justify" class="paragraph-source">     Символьные функции принимают символьные аргументы. Некоторые символьные функции возвращают символьные значения, остальные возвращают числовые значения. Функции, возвращающие символьные значения, всегда возвращают значение типа VARCHAR2, с двумя исключениями. Функции UPPER и LOWER возвращают значение типа CHAR, если им передан аргумент типа CHAR, и значение типа VARCHAR2 в противном случае. </p><p align="left" class="paragraph-source"><b>function CONCAT (str1 VARCHAR2, str2 VARCHAR2) return VARCHAR2 </b></p><p align="justify" class="paragraph-source">     Присоединяет строку str2 к строке str1 и возвращает результат. Если один из аргументов пуст, CONCAT возвращает другой аргумент. Если оба аргумента пусты, CONCAT возвращает NULL. </p><p align="left" class="paragraph-source"><b>function LENGTH (str CHAR) return NUMBER function LENGTH (str VARCHAR2) return NUMBER </b></p><p align="justify" class="paragraph-source">     Возвращает число СИМВОЛОВ в строке str. Если строка str имеет тип CHAR, то в длину входят хвостовые пробелы. Если строка str пуста , LENGTH возвращает NULL. </p><p align="left" class="paragraph-source"><b>function LOWER (str CAR) return CHAR function LOWER (str VARCHAR2) return VARCHAR2 </b></p><p align="justify" class="paragraph-source">     Возвращает строку str, в которой все буквы преобразованы в строчные. </p><p align="left" class="paragraph-source"><b>function SUBSTR (str VARCHAR2, pos NUMBER [, len NUMBER]]) return VARCHAR2 </b></p><p align="justify" class="paragraph-source">     Возвращает подстроку строки str, начинающуюся с СИМВОЛЬНОЙ позиции pos и содержащую len символов (или, если число len опущено, все символы до конца строки str). Значение pos не может быть нулевым. Если значение pos отрицательно, SUBSTR подсчитывает символы от конца строки str. Число len должно быть положительным . </p></div><span id="lnkb8b5731f4b29408280d285ccf75b689f"> </span><div class="section"><p align="justify" class="paragraph-source">     Функции преобразования конвертируют значение из одного типа данных в другой. </p><p align="justify" class="paragraph-source"><b>function TO_CHAR (dte DATE [, fmt VARCHAR2 [, nlsparms] ]) return VARCHAR2 </b></p><p align="justify" class="paragraph-source">     Преобразует дату dte в символьную строку типа VARCHAR2 в формате, заданном моделью формата fmt. (Допустимые модели формата приведены в описании функции TO_DATE.) Если вы опустите fmt, подразумевается умалчиваемый формат даты. </p><p align="justify" class="paragraph-source">     Аргумент nlsparms специфицирует язык, в котором возвращаются названия или сокращения месяцев и дней. Он имеет следующий вид: </p><p align="justify" class="paragraph-source">'NLS_DATE_LANGUAGE = &lt;язык&gt;' </p><p align="justify" class="paragraph-source">     Если вы опустите nlsparms, то TO_CHAR использует умалчиваемый язык для текущей сессии. </p><p align="justify" class="paragraph-source"><b>function TO_DATE (str VARCHAR2 [, fmt VARCHAR2 [, nlsparms] ]) return DATE function TO_DATE (num NUMBER, [, fmt VARCHAR2 [, nlsparms] ]) return DATE </b></p><p align="justify" class="paragraph-source">     Преобразует строку str или число num в значение даты в формате, заданном fmt. Допустимые модели формата приведены в таблице 4: </p></div><span id="lnkfae65d113ed24cdb9920c02dfd93057a"> </span><div align="center"><div class="inline-table-container"><p align="left" class="unit-title"> Таблица 4 - Допустимые модели формата </p><table class="inline-table"><col width="282" /><col width="283" /><tbody><tr><td style="background-color:#ffffff"><p align="center" class="inline-table"><b>Модель формата</b></p></td><td style="background-color:#ffffff"><p align="center" class="inline-table"><b>Описание </b></p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">CC,SCC </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">век (S префиксует даты до н.э. минусом) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">YYYY,SYYYY </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">год (S префиксует даты до н.э. минусом) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">IYYY </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">год в стандарте ISO </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">YYY,YY,Y </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">последние три, две или одна цифра года </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">IYY,IY,I </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">то же для года ISO</p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">Y,YYY </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">год с запятой </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">YEAR,SYEAR </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">год прописью (S префиксует даты до н.э. минусом) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">RR </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">последние две цифры года в новом веке </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">BC,AD </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">индикатор BC или AD </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">B.C.,A.D. </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">индикатор B.C. или A.D.</p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">Q </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">квартал (1-4) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">MM </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">месяц (1-12) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">RM </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">римский номер месяца (I-XII) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">MONTH </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">название месяца </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">MON </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">сокращенное название месяца </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">WW </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">неделя года (1-53) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">IWW</p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">неделя года (1-52 или 1-53) по ISO </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">W </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">неделя месяца (1-5) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">DDD </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">день года (1-366) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">DD </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">день месяца (1-31) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">D </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">день недели (1-7) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">DAY </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">название дня </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">DY </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">сокращенное название дня  </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">J </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">юлианский день (число дней с 1 января 4712 г. до н.э.) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">AM,PM </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">индикатор полудня </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">A.M.,P.M. </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">индикатор полудня с точками </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">HH,HH12 </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">час дня (1-12)</p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">HH24 </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">час суток (0-23)</p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">MI </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">минута (0-59) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">SS </p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">секунда (0-59) </p></td></tr><tr><td style="background-color:#ffffff"><p align="left" class="inline-table">SSSSS</p></td><td style="background-color:#ffffff"><p align="left" class="inline-table">секунд после полуночи (0-86399) </p></td></tr></tbody></table><p align="left" class="unit-comment">     Если формат опущен, подразумевается, что строка str задана в умалчиваемом формате даты. </p></div></div><span id="lnk5116e5fd92a8499f9c66bcc3be2a7b69"> </span><div class="section"><p align="justify" class="paragraph-source">     Если аргумент fmt имеет значение 'J' (юлианский день), то число num должно быть целым. Аргумент nlsparms специфицирует язык, в котором возвращаются названия или сокращения месяцев и дней. Он имеет следующий вид: </p><p align="left" class="paragraph-source">'NLS_DATE_LANGUAGE = &lt;язык&gt;' </p><p align="left" class="paragraph-source">     Если опустить nlsparms, то TO_DATE использует умалчиваемый язык для текущей сессии. </p></div><span id="lnk293340dfea8444bbb7047b2aca55b0d2"> </span><div class="section"><p align="left" class="paragraph-source">     Календарные функции принимают аргументы и возвращают значения в формате DATE, например: </p><p align="left" class="paragraph-source"><b>function LAST_DAY (dte DATE) return DATE </b></p><p align="left" class="paragraph-source">     Возвращает дату последнего дня месяца, содержащего дату dte. </p><p align="left" class="paragraph-source"><b>function SYSDATE return DATE </b></p><p align="left" class="paragraph-source">     Возвращает текущее значение даты/времени в системе. Эта функция не принимает аргументов. </p></div><span id="lnkabec7193d5814c4fbc6a62216f0340ad"> </span><div class="section"><p align="left" class="paragraph-source">     <b>Смешанные функции </b></p></div><span id="lnkbd39264b03a64818a1824968f3b298fe"> </span><div class="section"><p align="left" class="paragraph-source"><b>function DECODE (expr, search1, result1 [, search2, result2] ... [default] ) </b></p><p align="justify" class="paragraph-source">     Значение выражения expr сравнивается с каждым из значений search. Если expr совпадает с каким-либо search, возвращается соответствующее значение result. Если ни одного совпадения не найдено, возвращается значение default (или NULL, если значение default опущено). expr может иметь любой тип данных, но значения search должны иметь тот же тип, как у expr. Возвращаемое значение принудительно приводится к тому типу данных, как у result1. Функция DECODE допускается только в предложениях SQL. </p><p align="left" class="paragraph-source"><b>function USER return VARCHAR2 </b></p><p align="justify" class="paragraph-source">     Возвращает имя текущего пользователя ORACLE. Эта функция не имеет аргументов. </p></div><span id="lnk0184263b11244637bf39f2984014eb92"> </span><div class="section"><p align="justify" class="paragraph-source">     Для закрепления на практике изученного теоретического материала рекомендуется выполнить <a title="" target="_self" href="../../03/content/example2.html#lnk1b4ec536f7354bae95b30e6d2cbed639">лабораторную работу № 2. </a></p></div></div></td></tr></table></td></tr><tr><td id="bottomOuter"><table id="bottomInner"><tr><td class="cell1"><div> </div></td><td class="cell2"><div>© 2012 ХНУРЭ, ПИ, Широкопетлева М.С., <a href="mailto:mshirokopetleva@gmail.com">mshirokopetleva@gmail.com</a>;   ХНУРЭ, ПИ, Черепанова Ю.Ю.;   ХНУРЭ, ПИ, Мазурова О.А.<br /><a href="http://lersus.de/" title="Данный курс создан с помощью авторской системы LERSUS" target="_blank">Разработано с помощью LERSUS</a></div></td></tr></table></td></tr></table></body></html>